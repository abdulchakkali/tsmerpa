{"triggers":[],"nodes":[{"uid":"ef74ee39-46f9-4b12-a1e6-11740ae86c39","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d691bac2-14ea-470f-b538-b1e51fcbcaad","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"dDataConfig","value":{"type":"DICTIONARY","expression":"$dConfig$"}},{"key":"sAAtaskName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"sLogType","value":{"type":"STRING","string":"Process"}},{"key":"sMessage","value":{"type":"STRING","string":"--------------------Create Output Report START--------------------------------------------"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/RTA/Reusable/RU2-Log"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4744fb0e-9ce2-4b6d-8132-3431727d99aa","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0d7e6287-ef96-4786-b84b-ea23320366b0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$dConfig{OutputFolderPath}$\\Report\\$dConfig{sYearMonthDayFolder}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sReportPath"}},{"uid":"20031bfd-67a2-4fb3-a808-c656bd6344fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ea55f6ef-aa59-4cb1-b86c-bec76a1f7211","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sReportPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sReportPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"62848c0e-5426-4cdb-80a6-6d9abfc996e9","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$dConfig{TemplateFolderPath}$/$dConfig{ReportName}$.xlsx"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$sReportPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8d4e34b4-4b0d-4beb-9d60-518fe20b3e94","commandName":"renameFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sReportPath$/$dConfig{ReportName}$.xlsx"}},{"name":"newFileName","value":{"type":"STRING","expression":"$sReportPath$/$dConfig{ReportName}$_$dConfig{sCurrentTime}$.xlsx"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"01 Copy Template to Output Folder and Rename"}}]},{"uid":"a0af9872-2edb-4f55-ba68-15784eea390c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fb6ecb0d-d8d7-4ef5-baf9-6dcb1105f394","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sOutputFile"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$sReportPath$/$dConfig{ReportName}$_$dConfig{sCurrentTime}$.xlsx;Extended Properties=\"Excel 12.0 Xml;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"369d4d70-9515-42e4-8a73-16a5f77aef15","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sDownloadedFile"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$dConfig{TempFolderPath}$\\$dConfig{DownloadReportName}$.xlsx;Extended Properties=\"Excel 12.0 Xml;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e9f99814-f1af-4555-8b61-ea3ca16f89c7","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sDownloadedFile"}},{"name":"query","value":{"type":"STRING","string":"SELECT * FROM [List of Service Requests$]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3501f719-bd95-43d5-816f-617f15dc8657","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"91b6fbc3-fe9a-478d-bc2b-016a74610a75","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yy"}}],"returnTo":{"type":"VARIABLE","variableName":"sProcessingDate"}},{"uid":"2f4f1535-af17-4f4d-88d7-cc637cbdc995","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rServiceRequestRecord{\"Service Request\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sServiceRequestNumber"}},{"uid":"961d700c-42a3-4b63-b4db-05358b947309","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rServiceRequestRecord{\"SR Reported Date\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sServiceRequestCreationDate"}},{"uid":"e50cc05a-5540-4810-9943-4cb29b5dc23d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rServiceRequestRecord{\"Platenum\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBusPlateNumber"}},{"uid":"58654e08-599f-4283-9112-ddc8e205e571","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rServiceRequestRecord{\"Body Number\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sBodyNumber"}},{"uid":"2f731112-4db0-431e-b771-d2627154f870","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rServiceRequestRecord{\"Affected Person\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"sResponsibleDriver"}},{"uid":"c585cf56-bd67-4709-9bb7-f94ccf856dbf","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sOutputFile"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO [Sheet1$$] ([Processing Date],[Service Request Num],[Service Request Creation Date],[Bus Plate Number],[Body Num],[Responsible Driver],[Transaction Status]) VALUES ('$sProcessingDate$','$sServiceRequestNumber$','$sServiceRequestCreationDate$','$sBusPlateNumber$','$sBodyNumber$','$sResponsibleDriver$','InProgress')"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rServiceRequestRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sDownloadedFile"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"3a77b251-61f8-4fbb-8187-810f2de13292","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sOutputFile"}}]},{"uid":"84970b34-611c-44b2-ac3b-2bb0817fc4e8","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sDownloadedFile"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"02Copy Details from Downloaded Report to Output Report"}}]},{"uid":"be414656-70cb-4eab-9f9c-2e9140abf50f","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"bTaskCompeted"}},{"uid":"f88b49e8-e19c-436b-b532-aa13262c1802","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"dDataConfig","value":{"type":"DICTIONARY","expression":"$dConfig$"}},{"key":"sAAtaskName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"sLogType","value":{"type":"STRING","string":"Process"}},{"key":"sMessage","value":{"type":"STRING","string":"--------------------Create Output Report END--------------------------------------------"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/RTA/Reusable/RU2-Log"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"261b3c6a-1952-448e-a1bb-3d264938af4d","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8f827842-a793-4189-92e0-07caf246e0d8","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"dDataConfig","value":{"type":"DICTIONARY","expression":"$dConfig$"}},{"key":"sAAtaskName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"sLogType","value":{"type":"STRING","string":"Error"}},{"key":"nErrorLIneNumber","value":{"type":"NUMBER","expression":"$nErrorLineNumber$"}},{"key":"sMessage","value":{"type":"STRING","expression":"$sErrorDescription$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/RTA/Reusable/RU2-Log"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"dConfig","description":"","type":"DICTIONARY","readOnly":false,"input":true,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"ErrorLogFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Documents\\RTA_RPA\\RPA_STG\\Bus Accident Handling\\U02-Work Order Creation\\Error Log"}},{"key":"ProcessLogFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Documents\\RTA_RPA\\RPA_STG\\Bus Accident Handling\\U02-Work Order Creation\\Process Log"}},{"key":"DownloadFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Downloads"}},{"key":"TempFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Documents\\RTA_RPA\\RPA_STG\\Bus Accident Handling\\U02-Work Order Creation\\Temp"}},{"key":"TemplateFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Documents\\RTA_RPA\\RPA_STG\\Bus Accident Handling\\U02-Work Order Creation\\Template"}},{"key":"sYearMonthDayFolder","value":{"type":"STRING","string":"2021/4/26"}},{"key":"ReportName","value":{"type":"STRING","string":"Work Order Creation"}},{"key":"sCurrentTime","value":{"type":"STRING","string":"10_53"}},{"key":"OutputFolderPath","value":{"type":"STRING","string":"C:\\Users\\Kalyani.Kodukula\\Documents\\RTA_RPA\\RPA_STG\\Bus Accident Handling\\U02-Work Order Creation\\Output"}}]}},{"name":"nErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sReportPath","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rServiceRequestRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"sProcessingDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sServiceRequestNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sServiceRequestCreationDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sBusPlateNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sBodyNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sResponsibleDriver","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"bTaskCompeted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}}],"breakpoints":["8f827842-a793-4189-92e0-07caf246e0d8","a0af9872-2edb-4f55-ba68-15784eea390c"],"packages":[{"name":"Boolean","version":"2.1.0-20201014-042509"},{"name":"Database","version":"2.2.0-20201013-052941"},{"name":"Datetime","version":"2.2.0-20201014-042531"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"Folder","version":"3.0.0-20201016-065517"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Loop","version":"2.1.0-20200831-031540"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"TaskBot","version":"2.0.1-20201023-202703"}],"workItemTemplateName":null}