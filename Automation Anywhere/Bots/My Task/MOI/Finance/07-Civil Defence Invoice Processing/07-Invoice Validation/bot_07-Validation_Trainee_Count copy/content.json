{"triggers":[],"nodes":[{"uid":"14dc236c-fd5c-40c3-875a-be35d32c595b","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vVendorNumber$,$vTimeStamp$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"33f45c06-3d60-43b7-b58c-44675f5d7afc","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9f7933c2-c0dc-44df-9897-0c496bc7331b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4981b6f9-e328-4d4c-8db3-3e4c2ae3fab9","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b77f4015-0aa9-48ac-80d6-68b7a5ba049c","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Invoice"}},{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Input/I$vVendorNumber$.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"534a952e-2a7f-403f-bcfb-281fb9087cc3","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Invoice"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"A2"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvoiceNumber"}},{"uid":"8dc54ad8-7612-4dfa-93b8-a20170fdc744","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Invoice"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"D2"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvTraineeCount"}},{"uid":"dd0511f1-5a57-4eba-a28c-8c96d46c8aed","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Invoice"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"E2"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvTotal"}},{"uid":"791497ba-5e75-4416-8ce4-69ab3b756e57","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Invoice"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"2bae4445-8f12-47e5-8b2e-dfffa83042a4","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$vVendorNumber$,$vInvTraineeCount$,$vInvTotal$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Temp/I$vVendorNumber$.xlsx"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Read the Invoice details"}}]},{"uid":"2461a5af-9e9c-44c2-809c-5002c41b881a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0218259a-cce8-4a18-9c5d-540cc7f38e87","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0cdd71de-8deb-4a18-92c8-b8f83d795a5f","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"SummaryReport"}},{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Temp/S$vInvoiceNumber$.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"be6dd2ab-7395-41b2-9592-6c02e42fa6c4","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"SummaryReport"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"D2"}}],"returnTo":{"type":"VARIABLE","variableName":"vSummaryTotal"}},{"uid":"33a93075-3977-49c9-afca-32b84a88ae50","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"SummaryReport"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"E2"}}],"returnTo":{"type":"VARIABLE","variableName":"vSummaryTraineeCount"}},{"uid":"4f919257-b5fc-478b-8c01-2e7ad1092f88","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"SummaryReport"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Temp/S$vInvoiceNumber$.xlsx"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Read the summary report"}}]},{"uid":"5d914475-d286-4afa-9281-9b9756d824ca","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"1823a34a-c3e4-4fce-b99d-8bb438f46dbd","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CivilReport"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionURL","value":{"type":"STRING","string":"Driver={Microsoft Text Driver (*.txt; *.csv)};Dbq=C:\\Users\\cO0527\\Documents\\MOI\\Finance\\07-Civil Defence Invoice Processing\\Input\\;Extensions=csv;"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d086c0c6-f85f-4c99-8991-c25168f92906","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CivilReport"}},{"name":"query","value":{"type":"STRING","expression":"SELECT COUNT(*) FROM [PP$vVendorNumber$.csv]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9c5707da-2b84-41c7-a4cb-723a635c9a2e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"7fed9d5b-54ed-4bea-a8cf-c4c58a6495ed","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCivilTraineeCountRow[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCivilTraineeCount"}},{"uid":"faf82d02-651b-4040-bb5b-566f4c20b9d9","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vCivilTraineeCountRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"CivilReport"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"a3a6dcc5-1e28-4f9f-a740-5078be678bed","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"CivilReport"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"CivilReport"}}]},{"uid":"7d14b54d-fdd4-4d4f-8b42-cbc42988ed8d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"759f1ee5-a838-4fad-bafa-471ac0882754","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"MsAccess"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"Microsoft.Jet.OLEDB.4.0"}},{"name":"dbFilePath","value":{"type":"FILE","string":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Master_DB/Invoice_Master.accdb"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"30b40805-b5eb-4a3b-96c9-ae8488876f68","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"MsAccess"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM Invoice_Table WHERE VendorID='$vVendorNumber$'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/cO0527/Documents/1.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"ANSI"}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]},{"uid":"a0a8ce4d-0a9d-4c86-8937-7b12ed9bf380","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"d10490e2-69f9-4be3-b0cd-5cc436e8fdc2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Log/Log_$vTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Error,The invoce number is duplicated"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vMsAccessRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"MsAccess"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Validate the Invoice Number with Ms access master"}}]},{"uid":"b6c4252b-6d79-4dad-9954-5884cec7c963","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"526a8c02-02df-4846-ad97-1957b4376093","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"872ee262-dd44-464b-bdb9-98d6fddd65e8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"-Total Trainee count not matched with civil report"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvResult"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCivilTraineeCount$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","expression":"$vInvTraineeCount$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"14b89681-8c4f-4b03-9713-a329660a5285","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"85351fd7-f69e-42f9-a349-ff66c3e95dc3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vInvResult$-Total Trainee count not matched with vendor summary report"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvResult"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCivilTraineeCount$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","expression":"$vSummaryTraineeCount$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"fa9b336f-533e-4e96-8d39-55f60a0879fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"df5cc82f-491d-4e6b-b8e7-7abf5fb3104f","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Report"}},{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Input/I$vVendorNumber$.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e203ae51-554a-4ac6-98af-0bed0d065af8","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Report"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"F2"}},{"name":"value","value":{"type":"STRING","expression":"$vInvResult$"}}]},{"uid":"0877a927-f968-44e1-8bfc-0c75e9ae376c","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Report"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Temp/I$vVendorNumber$.xlsx"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Validate the Trainee Count"}}]}],"branches":[{"uid":"6dcc84b6-92e9-4d21-bd4b-73ace5343e0f","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1a5cf99f-9ef8-435f-b39c-9ad2233314a0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file:///C:/Users/cO0527/Documents/MOI/Finance/07-Civil%20Defence%20Invoice%20Processing/Log/Log_$vTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Error,$vErrorDescription$,$vErrorLineNum.Number:toString$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNum"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vVendorNumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvTraineeCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvoiceNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvTotal","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSummaryTotal","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSummaryTraineeCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vCivilTraineeCountRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vCivilTraineeCount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vInvResult","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Matched"}},{"name":"vMsAccessRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":[],"packages":[{"name":"Database","version":"2.0.0-20200723-022707"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"Excel_MS","version":"4.0.0-20200723-234413"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"LogToFile","version":"2.2.0-20200831-031539"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"MessageBox","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20200723-201827"},{"name":"String","version":"3.0.0-20200721-222454"},{"name":"System","version":"3.0.0-20200831-031944"}],"workItemTemplateName":null}