{"triggers":[],"nodes":[{"uid":"3bb08b9a-1181-4fa7-9a05-4ecadb53a891","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"50756ef7-f92b-4fd2-b087-20d4d83dbd90","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"33d640fc-3a1b-4d01-8aea-09b5012bd9ca","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ab5d42dd-186d-4ca3-8c91-d46d375e2c41","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadCivilDefenseReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xCivilDefenseReportFileName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"dd186b53-1579-4129-b60c-944c459eab0f","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xEDirhamReportName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8e123252-1a11-49d8-9382-8204a33fa878","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadCivilDefenseReportDB"}},{"name":"query","value":{"type":"STRING","string":"Select * from [Worksheet$]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"64c426fb-5a7d-4a4a-8699-dbfac06e8d6c","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"492c4915-9532-4fa9-b032-d37f3b2f03f9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCivilDefenseRecord{\"رقم الإيصال\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTransactionID"}},{"uid":"3791c1f4-21d1-4b6f-8a25-37446e6f67fb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCivilDefenseRecord{\"المبلغ\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAmount"}},{"uid":"1e58fca1-8bee-4c6b-bf39-9523d99d772b","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"query","value":{"type":"STRING","expression":"Select count(*) from [Service Transaction Details Rep$$] Where [SRVC URN] = '$vTransactionID$' and [Transaction Amount-AED] = $vAmount$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"af94ef02-9f81-439b-88f2-8f191fd1219d","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"a9dd01c7-b000-46d5-90c4-07775d204039","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4d320680-5290-4b95-8cf5-b25188a543b8","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"vTransactionID"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vEDirhamReportRecord[0]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"0"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vEDirhamReportRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vCivilDefenseRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadCivilDefenseReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"8790ca40-6311-4f1a-95f8-0ac44121dfeb","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadCivilDefenseReportDB"}}]},{"uid":"3e5bde40-1c6f-4ab4-a9d6-f084f9c87496","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get missing transactions in civil defense report"}}]},{"uid":"39a1ae24-6bb7-449b-beab-f1630e33d3e3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"df3a438d-a661-4026-ae9b-54ba385e6a83","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadCivilDefenseReport"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xCivilDefenseReportFileName$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d63edcde-6efb-4bc3-bad7-85d708c6f3db","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Scripts/highlightCell.vbs"}}]},{"uid":"93aae494-e908-4ff2-b8f4-6e37f15c72e1","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"b7ced28f-9ee3-4322-b51c-d84c338c9c4c","commandName":"find","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadCivilDefenseReport"}}},{"name":"from","value":{"type":"STRING","string":"BEGINNING"}},{"name":"till","value":{"type":"STRING","string":"END"}},{"name":"findText","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"searchOptions","value":{"type":"STRING","string":"BYROWS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"matchEntireCell","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vList"}},{"uid":"11d6deda-5c27-4e55-a80a-ce31f963c382","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"9dfd9bbc-a45d-4aae-bb76-bcb746927b2c","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadCivilDefenseReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","expression":"$prompt-assignment$"}}]},{"uid":"91999207-192b-422e-a91f-7fa073a62868","commandName":"GetSingleCellAddress","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadCivilDefenseReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"c3a798b5-f8ea-4b1b-8a02-3330b12c70c0","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]},{"uid":"93fb1780-13fa-4ca4-99af-5bbaae3bd8d0","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCell$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"1f01841b-ebea-40fb-8c3c-1522e59f66b1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"M$prompt-assignment$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"004b7411-cfa2-4faa-a0ec-a9dea2cd7327","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"b67134ac-58e2-4484-81f2-aa6c1148c064","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}}]},{"uid":"055ed355-741c-414d-bb76-b3576d1e4df3","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadCivilDefenseReport"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Highlight in Civil Defense Report"}}]}],"branches":[{"uid":"610cb5b3-d521-4882-8ea4-ea8df0f07fd9","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"d791e377-edb3-4476-8379-a69684dccfbc","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"7c2af382-a7fd-4465-93c9-a81cb82e48ef","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"Missing File : $xCivilDefenseReportFileName$ or $xEDirhamReportName$ in the input folder"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xCivilDefenseReportFileName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xEDirhamReportName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"branches":[{"uid":"2db3071b-0cca-48a6-b83c-dfa991ffde0a","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6d8bf1a4-8e35-4b93-a591-dcba36db3837","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"eb519ca9-92ba-488a-8360-3d964410178b","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"xCivilDefenseReportFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"Civil Defense.xlsx"}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOIDEV\\Finance\\09-E-Dirham Processing"}},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"xScreenshotsFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Error_Screen"}},{"name":"xLogFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Log"}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"07-01-2021"}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vCivilDefenseRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vTransactionID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xEDirhamReportName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"eDirahim.xlsx"}},{"name":"vEDirhamReportRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"vCell","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vAmount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vTransactionIDList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}}],"breakpoints":["11d6deda-5c27-4e55-a80a-ce31f963c382","af94ef02-9f81-439b-88f2-8f191fd1219d","eb519ca9-92ba-488a-8360-3d964410178b"],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"Database","version":"2.1.0-20200913-060112"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"3.0.0-20200831-031944"},{"name":"TaskBot","version":"2.0.1-20200907-072949"},{"name":"VBScript","version":"2.3.0-20201105-205228"}],"workItemTemplateName":null}