{"triggers":[],"nodes":[{"uid":"5a0879fe-0291-422b-bb92-95e75a74f44d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f52f4829-b5fd-4272-86ef-a4296ab3631c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"331fb0ae-d59c-474b-9e02-533377a6c232","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"7781c6db-3410-4302-a9e0-4bab22968ada","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadSecurityCompaniesReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xSecurityCompaniesReportFileName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"7c54467b-1ff2-4261-be6c-7585e8648715","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xEDirhamReportName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"48c8f2c8-64c4-41d6-805f-9b52ab59f0a3","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadSecurityCompaniesReportDB"}},{"name":"query","value":{"type":"STRING","string":"Select * from [data$] where [Payment Reference No] <> 'N/A'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"0e43d506-0835-4a76-84c8-a4e02dbdcf23","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"11befb5b-76f1-4452-9a77-83186cc1a116","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSecuritiesCompanyRecord{\"Payment Reference No\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTransactionID"}},{"uid":"36fd87c3-e8d2-462a-9210-59cb69a0f39b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSecuritiesCompanyRecord{\"Total Amount\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAmount"}},{"uid":"2b669797-4ba0-4f3d-b8ed-e96ab542b084","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"943528a0-7487-4549-bafc-ba67aa95d213","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"query","value":{"type":"STRING","expression":"Select count(*) from [Service Transaction Details Rep$$] Where [SRVC URN] = '$vTransactionID$' and [Transaction Amount-AED] = $vAmount$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"56a151a4-c3a1-4616-b28b-744cde5e670c","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"221fdedf-562f-4f3a-b175-cdcffe937230","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d4351f78-25ba-42d6-adc2-37616ec1cbf2","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"vTransactionID"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vEDirhamReportRecord[0]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"0"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vEDirhamReportRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vTransactionID$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vSecuritiesCompanyRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadSecurityCompaniesReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"1c513e81-f543-41ed-9f02-a940a26299de","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadSecurityCompaniesReportDB"}}]},{"uid":"24fbd9f7-d795-44a5-959e-4297acbaa7e8","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get missing  transactions in Security Companies Report"}}]},{"uid":"dcd38f6b-3f19-440a-9201-73ba2b5835f5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0b3cc29d-ba3e-4e9e-b0c1-2dbcc77d2a80","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadSecurityCompaniesReport"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xSecurityCompaniesReportFileName$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6aff444f-f2ea-46df-90b2-bcc18bf80209","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Scripts/highlightCell.vbs"}}]},{"uid":"7fb5b0fd-9391-4c52-9039-bc2159230982","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"3d959e67-cab0-461e-9bcd-3b9e6cdcd8ec","commandName":"find","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadSecurityCompaniesReport"}}},{"name":"from","value":{"type":"STRING","string":"BEGINNING"}},{"name":"till","value":{"type":"STRING","string":"END"}},{"name":"findText","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"searchOptions","value":{"type":"STRING","string":"BYCOLUMNS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"matchEntireCell","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vList"}},{"uid":"f4a919e3-c943-4a86-aa99-1f1825a9b418","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ed8f8db9-964c-47a6-88e3-1ded4c2ba7e3","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadSecurityCompaniesReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","expression":"$prompt-assignment$"}}]},{"uid":"099997d1-b7b9-4029-aa29-5877028a91ea","commandName":"GetSingleCellAddress","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadSecurityCompaniesReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"be1f9150-9cef-47c2-b969-ddd367198b49","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]},{"uid":"d93babd1-7544-4a81-ad42-e33893fc89aa","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCell$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"77763445-3a8e-47b1-9048-0a171230926e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"E$prompt-assignment$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"7cdb6256-97f0-48ec-b92e-c6376aa9ef81","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"04a22d9e-72c1-49d0-8bd1-cf9f2799ab4d","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}}]},{"uid":"345314e3-46d9-42ed-963e-cc2139fe8ca3","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadSecurityCompaniesReport"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Highlight in Securities Companies report"}}]}],"branches":[{"uid":"397351e7-f92c-4ca4-9430-d4e79f63deb8","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"051d0b6d-96e4-4a1d-b460-01c05db326ae","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"8eb81088-492c-4e0e-b194-71a4a658087d","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"Missing Files : $xSecurityCompaniesReportFileName$ or $xEDirhamReportName$ in the input folder"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xSecurityCompaniesReportFileName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"branches":[{"uid":"e8b52b82-de7d-491a-b5f1-30dabf900c38","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9377ae1d-34f8-4ac0-a226-b003a6a307e2","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"d33f8250-f990-4742-bab1-2ea3b16dafe7","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"xScreenshotsFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Error_Screen"}},{"name":"xLogFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Log"}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"07-01-2021"}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOIDEV\\Finance\\09-E-Dirham Processing"}},{"name":"xEDirhamReportName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"eDirahim.xlsx"}},{"name":"vTransactionID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAmount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vEDirhamReportRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vTransactionIDList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"xSecurityCompaniesReportFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSecuritiesCompanyRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"vCell","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":["1c513e81-f543-41ed-9f02-a940a26299de","9377ae1d-34f8-4ac0-a226-b003a6a307e2"],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"Database","version":"2.1.0-20200913-060112"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"3.0.0-20200831-031944"},{"name":"TaskBot","version":"2.0.1-20200907-072949"},{"name":"VBScript","version":"2.3.0-20201105-205228"}],"workItemTemplateName":null}