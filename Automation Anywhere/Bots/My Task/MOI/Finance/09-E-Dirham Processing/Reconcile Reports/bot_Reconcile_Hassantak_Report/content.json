{"triggers":[],"nodes":[{"uid":"be084b8a-14c5-4341-960e-889f588da024","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"58fab8b1-f7f4-4db6-b571-1316aa0c39bb","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4f5c5eea-d5cc-4ca9-aff2-2126dc073053","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ad37df9e-072e-4df2-aded-63cfdf5526bf","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadHassantakReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xHassantakReportFileName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4f0dc0b8-b34f-4d70-9efc-01110e137c86","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/Input/$xEDirhamReportName$;Extended Properties=\"Excel 12.0;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"d51f6cd2-77de-4a4e-94f0-bfda9727a8a4","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadHassantakReportDB"}},{"name":"query","value":{"type":"STRING","string":"Select SUM([Total Amount]) as [Total Amount], PUN from [MOI Finance Report$]  WHERE PUN IS NOT NULL  AND PUN <> ' ' GROUP BY PUN"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"5c8fafd4-10c5-4105-9a2a-f04e843df9bf","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"8083fe3a-8fe1-4f24-ae9f-561d605af81a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vHassantakReportRecord{PUN}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vTransactionID"}},{"uid":"4d0babcc-b823-49e1-b3b2-dc85784a0ca1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vHassantakReportRecord{\"Total Amount\"}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAmount"}},{"uid":"961cd4f2-3547-4cac-bef9-579233705bef","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1189b412-7909-48e0-957b-37df7d83d9a0","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}},{"name":"query","value":{"type":"STRING","expression":"Select count(*) from [Service Transaction Details Rep$$] Where [SRVC URN] = '$vTransactionID$' and [Transaction Amount-AED] = $vAmount$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"11ba8c75-dddb-4d81-9bcd-3f002ae300f6","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"94b48b4f-0f03-4687-abda-9c342c5884ab","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8de23241-4d1a-4ab4-99f3-ef6496fea2b4","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"vTransactionID"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vEDirhamReportRecord[0]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"0"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vEDirhamReportRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vTransactionID$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vHassantakReportRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadHassantakReportDB"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"25f509af-b197-4293-8242-18858ae523e4","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadHassantakReportDB"}}]},{"uid":"e9cbbfde-5940-4040-ae4a-4ae7bfcdb62c","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadEDirhamReportDB"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Get missing Transactions in Hasantak Report"}}]},{"uid":"f730a9f8-2a71-4ba1-a446-01067e605581","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"e8fa29be-6c3a-4b46-910a-70f15700c765","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sReadHassantakReport"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xHassantakReportFileName$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8fba1004-3738-444b-959f-1761acaeb565","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Scripts/highlightCell.vbs"}}]},{"uid":"afa34826-c3e5-437a-b061-f0cb38634941","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"a5979a67-6cf2-4e2c-887b-2bc411ae9033","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4c529a9c-77fb-44df-8008-43ff3d5ca45f","commandName":"find","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadHassantakReport"}}},{"name":"from","value":{"type":"STRING","string":"BEGINNING"}},{"name":"till","value":{"type":"STRING","string":"END"}},{"name":"findText","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"searchOptions","value":{"type":"STRING","string":"BYROWS"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"matchEntireCell","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"vList"}},{"uid":"63f120d7-6f2b-4a53-8232-ec9b9dbb9b6d","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"27976227-f9a6-467d-ae8c-d541f8bca5e1","commandName":"GoToCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadHassantakReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"SpecificCell"}},{"name":"cell","value":{"type":"STRING","expression":"$prompt-assignment$"}}]},{"uid":"af429c9e-8d73-4af5-b32c-cdd33df3348b","commandName":"GetSingleCellAddress","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadHassantakReport"}}},{"name":"cellOption","value":{"type":"STRING","string":"ACTIVE_CELL"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"8d0715c1-d5d7-4e39-9206-49763ac87c89","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]},{"uid":"41d405c6-f2a4-455b-9c87-64c033eca958","commandName":"subString","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vCell$"}},{"name":"startIndex","value":{"type":"NUMBER","number":"2"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"540bba93-78b9-4f64-a036-f8cbd80852b7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"H$prompt-assignment$"}}],"returnTo":{"type":"VARIABLE","variableName":"vCell"}},{"uid":"042b3c72-73ab-4a5f-8059-8310d57d80e7","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}},{"name":"functionName","value":{"type":"STRING","string":""}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"vCell"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"vTransactionIDList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]},{"uid":"ead390bb-4fd7-472e-b4e4-e3aeaa5b1be1","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"sHighlightCell"}}]},{"uid":"923e5437-b3a3-4feb-9cfb-0a41040af7dd","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"sReadHassantakReport"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Highlight in Hasantak Report"}}]}],"branches":[{"uid":"09975b6a-20a9-48fd-b8a0-0cf4a5a28bba","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"6c926330-216b-4812-a84e-7a678ce8b61b","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"e10ae3ea-c483-4679-a100-e76a7f451971","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"Missing File : $xHassantakReportFileName$ or $xEDirhamReportName$ in the input folder"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xHassantakReportFileName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/Input/$xEDirhamReportName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"branches":[{"uid":"6e4e783c-3cad-46bd-8fd4-667007a23dfe","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d33245e1-bb62-40ac-99b4-37a4dda22681","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"41506d28-be1c-450d-ba0d-52cc4feb8529","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xScreenshotsFolderPath$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xLogFolderPath$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"xScreenshotsFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Error_Screen"}},{"name":"xLogFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOI\\Finance\\09-E-Dirham Processing\\Log"}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"07-01-2021"}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"xHassantakReportFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"C:\\Users\\co0526\\Documents\\MOIDEV\\Finance\\09-E-Dirham Processing"}},{"name":"xEDirhamReportName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":"eDirahim.xlsx"}},{"name":"vTransactionID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAmount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vEDirhamReportRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"vCell","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vHassantakReportRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vTransactionIDList","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}}],"breakpoints":["8d0715c1-d5d7-4e39-9206-49763ac87c89","8fba1004-3738-444b-959f-1761acaeb565"],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"Database","version":"2.1.0-20200913-060112"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"List","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"3.0.0-20200831-031944"},{"name":"TaskBot","version":"2.0.1-20200907-072949"},{"name":"VBScript","version":"2.3.0-20201105-205228"}],"workItemTemplateName":null}