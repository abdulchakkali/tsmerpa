{"triggers":[],"nodes":[{"uid":"083f1bc6-c0de-4076-b23a-5e9d642e31c9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"29c346d2-b107-4d96-b4a4-9a17222a7498","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"2236f3e1-c979-4e9d-b9e6-03b17ffd41ee","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f07e539d-ab1d-4eed-9729-6d772b2726fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b0206fec-0bea-4a0b-8acd-a27f60ec9ee3","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputfile"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xInputFolderName$/$xFileNameExt{name}$.$xFileNameExt{extension}$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4e07849e-9436-471e-ac95-9607b0537add","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Inputfile"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"A1"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"returnTo":{"type":"VARIABLE","variableName":"vColumnA"}},{"uid":"6459962b-bfe4-4677-90f1-cf55c4a5891e","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Inputfile"}}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"B1"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}}],"returnTo":{"type":"VARIABLE","variableName":"vColumnB"}},{"uid":"3ae4ecd2-a7fb-4c3a-aed0-bbfd3c47224a","commandName":"getWorksheetNames","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Inputfile"}}}],"returnTo":{"type":"VARIABLE","variableName":"vSheetName"}},{"uid":"61e96355-a72f-4fed-9d7e-b70614133104","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Inputfile"}}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"3beccf32-e956-4e74-b942-6fdc19633849","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8f4cd231-9553-4465-8e63-04dfe8441a97","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"16224b7e-c2d4-4ce9-a471-aabf226b0b66","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputsheet"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/$xInputFolderName$/$xFileNameExt{name}$.$xFileNameExt{extension}$;Extended Properties=\"Excel 12.0 Xml;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"cbac8998-538e-429f-83bf-1aa0774f7a8f","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputsheet"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM [$vSheetName[0]$$$]"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"42def1b9-504d-4f91-9995-92e10a49eccb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Connection string to outputfile"}}]},{"uid":"97102b2f-60bb-44dc-9439-937c9e201f5a","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xTemplateFolderName$/$xOutputFileName$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$xFolderPath$/$xOutputFolderName$/$xOutputFileName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6452132c-9836-4915-9310-5ebe3897a4b8","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/$xOutputFolderName$/$xOutputFileName$;Extended Properties=\"Excel 12.0 Xml;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"431a8e52-e4fe-4ff3-bd6d-462546a54630","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"63066f74-cde0-4511-9692-00d1f3b40098","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2e1c350b-8fa9-49b2-baa3-6420c50212de","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Variable Reinitialize"}}]},{"uid":"e1fabd31-2f3d-4330-944a-9d31dccd56c4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDeptID"}},{"uid":"6269c9b6-2b31-4359-bf7d-42aa0a401eee","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vStatementSequence"}},{"uid":"106ce33b-5b10-4db8-8a82-167644b70db3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vRecord[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDeptID"}},{"uid":"6fe5d73e-d1ee-403b-a9ad-c57169105ae2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vRecord[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatementSequence"}},{"uid":"b38a28f8-942a-4235-ae23-f84b455941b4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"84b11314-6a01-42dd-827f-594020d788fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d8a1467f-89d3-4d9f-96ab-83763826f5e5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Info,DeptID$vDeptID$ Statement$vStatementSequence$ start"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"6b7c6fa1-c232-4405-960b-a59b9baa7df7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"<soap:Body>      <rpas:GetPettyCashBillsRequest>         <rpas:DepartmentId>$vDeptID$</rpas:DepartmentId>         <rpas:StatementSequence>$vStatementSequence$</rpas:StatementSequence>      </rpas:GetPettyCashBillsRequest>   </soap:Body>"}}],"returnTo":{"type":"VARIABLE","variableName":"xSOAPBody"}},{"uid":"98a0da21-0c47-4283-8802-ee37aa699fdd","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderName","value":{"type":"STRING","expression":"$xScreenshotsFolderName$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xFolderPath","value":{"type":"STRING","expression":"$xFolderPath$"}},{"key":"xLogFolderName","value":{"type":"STRING","expression":"$xLogFolderName$"}},{"key":"xMOIAPIEndpoint","value":{"type":"STRING","expression":"$xMOIAPIEndpoint$"}},{"key":"xMOIAPIService","value":{"type":"STRING","expression":"$xMOIAPIService$"}},{"key":"xMOIAPIPort","value":{"type":"STRING","expression":"$xMOIAPIPort$"}},{"key":"xSOAPBody","value":{"type":"STRING","expression":"$xSOAPBody$"}},{"key":"xMOIOperation","value":{"type":"STRING","expression":"$xMOIOperation$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/SOAP_API_Request"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"xMOIWebserviceResponse"}},{"uid":"6122354a-3527-48a6-a839-f07751c7433c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$xMOIWebserviceResponse{vAPIResponse}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAPIResponse"}},{"uid":"499345ff-503a-46c0-883e-3fb7412ae140","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$xMOIWebserviceResponse{vStatusCode}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatusCode"}},{"uid":"c44e7a48-a96e-49d1-9aff-e7ee7ac2c49e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$xMOIWebserviceResponse{vErrorEnglishDescription}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorEnglishDescription"}},{"uid":"08d06868-44b1-4d90-8c91-810e22a1c858","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Info,web service response $vAPIResponse$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"693ccc46-e76a-4d91-9de3-7cc78fed6ab1","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d2855be3-0589-4347-9fa0-9843350bb780","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"197c2057-04a5-48a2-8823-e9e194a797f6","commandName":"startSession","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"inputType","value":{"type":"STRING","string":"text"}},{"name":"data","value":{"type":"STRING","expression":"$xMOIWebserviceResponse{vAPIResponse}$"}}]},{"uid":"6694b929-19ed-48bc-8f6e-361ba75b49e2","commandName":"getMultipleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']"}},{"name":"typeToReturn","value":{"type":"STRING","string":"text value"}}]},{"uid":"97da5f4d-c9ff-4c4d-b41a-c3709cfe9505","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"ba9b6b85-4eb7-461d-85cd-29ea5da37813","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='BillSubArtCode']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vBillSubArtCode"}},{"uid":"290537cb-86c8-4d58-b142-80b3e07b7672","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='DepartmentName']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vDepartmentName"}},{"uid":"e1b1ce78-07b6-42ec-a4ae-4d732021b863","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='StatementDate']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vStatementDate"}},{"uid":"e5154494-8714-4e61-aeb7-13b5d41d87fa","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='BillNumber']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vBillNumber"}},{"uid":"2decb100-bb3e-479f-a643-b14714a8eb58","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='TotalStatement']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTotalStatement"}},{"uid":"ada6f795-b6dc-44c8-8a86-d19b47ec3f4b","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='TotalStatementVAT']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTotalStatementVAT"}},{"uid":"6eb86c98-a38b-4134-8f5a-3c9faaffa8d2","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='BillAmount']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vBillAmount"}},{"uid":"1594c1cf-a7a9-4148-bb90-9863b35069a8","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='BillVAT']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vBillVAT"}},{"uid":"0ec56e28-9531-4226-8668-d80a3bcd998e","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"XML"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetPettyCashBillsResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='PettyCashBill']/*[local-name()='CompanyTaxNumber']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vTRNNum"}},{"uid":"d1d6ba0f-7231-4ed0-8308-e2b3ece8d932","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a5d76de5-199e-4770-9f6e-20982c48e11c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Get supplier num from config file"}}]},{"uid":"16a29015-50bb-4729-ac96-f69ce41163ee","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Config file"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFilePath$;Extended Properties=\"Excel 12.0 Xml;HDR=NO\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a5bb5c85-18a0-4b6c-a168-a23538b8d652","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Config file"}},{"name":"query","value":{"type":"STRING","expression":"SELECT F4 FROM [Vendor_Details$$] WHERE F3 = $vStatementSequence$"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9348e37b-4975-4e32-9397-10474ffcd448","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"2a695acd-e1de-48e8-a738-66cf7e2a4653","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vConfigRecord[0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSupplierNum"}},{"uid":"6f619a31-9ec5-406d-bf62-aaa118c145a6","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vConfigRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Config file"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"53f71f18-dcef-48d4-b764-ab92d78ed64d","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Config file"}}]},{"uid":"8c3d4d17-d81b-4f8a-9722-ee68673a2965","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Invoice number "}}]},{"uid":"81230cfe-e165-4784-a467-278271ed65e8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vDeptID$/$vStatementSequence$"}}],"returnTo":{"type":"VARIABLE","variableName":"vInvNumber"}},{"uid":"60adc712-dfa2-4804-9017-9849d27afd2c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Concatenate the description"}}]},{"uid":"8bc2e0bf-ba9d-4ff0-afaf-19f6c922096c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"R-$vTRNNum$-$vDepartmentName$-$vBillNumber$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDescription"}},{"uid":"7f4d27bb-8f00-495b-a391-bcebddd9a82a","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"vComment","value":{"type":"STRING","expression":"$vDescription$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/ArabicString_Handler"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"xArabicStringHandler"}},{"uid":"719d1f96-8556-4ec8-b7ed-a71878dd73ed","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$xArabicStringHandler{vComment}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vDescription"}},{"uid":"5a085a15-9992-40ec-b29a-304bb8206e55","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Date:Current date"}}]},{"uid":"b0d82ff8-3a1f-467e-89bd-677cfbb080ae","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd-MMM-yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"vDate"}},{"uid":"aed84ef5-bfce-4175-a434-58866aadf835","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Total amount"}}]},{"uid":"e698ed85-a46c-4315-853c-d37e74898664","commandName":"toNumber","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTotalStatement$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAmount"}},{"uid":"969c1411-374f-4184-a9ee-facc73a569de","commandName":"toNumber","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vTotalStatementVAT$"}}],"returnTo":{"type":"VARIABLE","variableName":"vVat"}},{"uid":"3d5a4669-b5b6-4dca-b35f-e1396a517bc7","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vAmount$+$vVat$"}}],"returnTo":{"type":"VARIABLE","variableName":"vAmount"}},{"uid":"a11de5d2-ec54-423c-bd17-cb4f80ecd176","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Vat details"}}]},{"uid":"6bb9e047-7e86-4d1a-9b5e-1697c1e2804c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3dd43d8c-44da-44cb-81dc-44921a50e0f7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"OUT OF SCOPE"}}],"returnTo":{"type":"VARIABLE","variableName":"vBillVAT"}}],"branches":[{"uid":"f34106f2-cce9-4770-95be-74b1adc312b2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"6844ba42-24b0-46ac-8934-fb0d3cf22260","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"5% STANDARD VAT"}}],"returnTo":{"type":"VARIABLE","variableName":"vBillVAT"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBillVAT$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBillVAT$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"0"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"eefcd8ec-386c-4058-a7c1-f69725b73f6f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5837e234-dfd4-48ea-a221-31ef54a3d509","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"InProgress"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"2ddbd9d8-dfe7-4c41-ae77-2fae7bf9d6c5","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO [Sheet1$$] (VendorID,SupplierNum,FilterColumnValue,Description,InvNum,InvDate,TraineeCount,TotalAmount,LineItemTotal,VatEquation,TRN,Status) VALUES('$vDeptID$','$vSupplierNum$','$vBillSubArtCode$',$vDescription$,'$vInvNumber$','$vDate$','$vBillNumber$','$vAmount.Number:toString$','$vBillAmount$','$vBillVAT$','$vTRNNum$','$vStatus$')"}}]}],"branches":[{"uid":"39890361-ecb1-4d7d-9a27-fbb90076c914","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"4aa12eea-596b-40a2-b35e-9280fccfbf50","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"NotCompleted"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"731723f7-0827-483a-8143-61851d1b706d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Some of the required field is blank"}}],"returnTo":{"type":"VARIABLE","variableName":"vComment"}},{"uid":"cebc83e4-2850-44a6-83db-aa8cbdceac6b","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO [Sheet1$$] (VendorID,SupplierNum,FilterColumnValue,Description,InvNum,InvDate,TraineeCount,TotalAmount,LineItemTotal,VatEquation,TRN,Status,Comment) VALUES('$vDeptID$','$vSupplierNum$','$vBillSubArtCode$','$vDescription$','$vInvNumber$','$vDate$','$vBillNumber$','$vAmount.Number:toString$','$vBillAmount$','$vBillVAT$','$vTRNNum$','$vStatus$','$vComment$')"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBillSubArtCode$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDescription$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vStatementSequence$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"},"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$vAmount$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vBillAmount$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"operator":"AND"},"operator":"AND"},"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"05-Populate output file"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"session","value":{"type":"STRING","string":"XML"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.xml","packageName":"XML"}}]}],"branches":[{"uid":"6dcc67f6-4786-414b-8946-fe30db8d0052","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"b5ad2aa2-23e3-478a-8899-a8355a002ecc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"NotCompleted"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"d60961c8-58cf-40a5-8acb-d5c8bee57308","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vErrorEnglishDescription$"}}],"returnTo":{"type":"VARIABLE","variableName":"vComment"}},{"uid":"654bba8c-1cf8-45f7-b67b-68856ac630fd","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO [Sheet1$$] (VendorID,SupplierNum,FilterColumnValue,Description,InvNum,InvDate,TraineeCount,TotalAmount,LineItemTotal,VatEquation,TRN,Status,Comment) VALUES('$vDeptID$','$vSupplierNum$','$vBillSubArtCode$','$vDescription$','$vInvNumber$','$vDate$','$vBillNumber$','$vAmount.Number:toString$','$vBillAmount$','$vBillVAT$','$vTRNNum$','$vStatus$','$vComment$')"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vStatusCode$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"200"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"04-Read the XML "}}]}],"branches":[{"uid":"2f057762-256a-4a8f-8f61-62d92cfd8435","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"2ebc54d4-6efc-41ac-8e1c-775f240982db","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Info,businessunit or sheet ID empty in input file $xFileNameExt{name}$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vDeptID$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vStatementSequence$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"03-Invoice Details: Call webservice to get the invoice details from MOI system"}}]}],"branches":[{"uid":"c7de92dc-2224-41c5-be26-caada49a3238","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"b2fd877a-84af-495e-b8c6-c6c304720f4a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Error,$vErrorLineNumber.Number:toString$,$vErrorDescription$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"2a6e8807-3279-49f5-b949-502987bfbcb2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"NotCompleted"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatus"}},{"uid":"1fe3c032-5853-420c-855b-8b14c56c189c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"RPA fail to process due to techical issue :$vErrorDescription$"}}],"returnTo":{"type":"VARIABLE","variableName":"vComment"}},{"uid":"b3cd7872-7f46-4231-bf9a-d72d018c4b90","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}},{"name":"query","value":{"type":"STRING","expression":"INSERT INTO [Sheet1$$] (VendorID,SupplierNum,FilterColumnValue,Description,InvNum,InvDate,TraineeCount,TotalAmount,LineItemTotal,VatEquation,TRN,Status,Comment) VALUES('$vDeptID$','$vSupplierNum$','$vBillSubArtCode$','$vDescription$','$vInvNumber$','$vDate$','$vBillNumber$','$vAmount.Number:toString$','$vBillAmount$','$vBillVAT$','$vTRNNum$','$vStatus$','$vComment$')"}}]},{"uid":"dbbf9d88-363b-4c80-988a-48326a1d8ce7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"14c0c5da-4878-42c0-b808-5ec449566777","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputsheet"}}]},{"uid":"2f084540-464c-4bca-b01f-c3eb0880fa54","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}}]}],"branches":[{"uid":"5b141abc-976d-497a-9192-25033f0f6d9f","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputsheet"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"0b36bf21-3e68-4599-932d-70459d40026c","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Inputsheet"}}]},{"uid":"92cf72d8-77a2-4f03-a07f-afa6dbdca3df","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"02-Read : Input file records"}}]}],"branches":[{"uid":"6ab85556-8d30-485b-9720-1013768ed949","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"dad1d122-a176-40d5-a953-88a45ca90e9b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Info,File $xFileNameExt{name}$ not in required format"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vColumnA$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Bussiness Unit"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vColumnB$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Sheet ID"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"d6dbecae-6a38-46e9-bf84-e6d862a9248f","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"e3f0b412-6771-444f-877f-1f055406412c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Info,File $xFileNameExt{name}$ not in xlsx extension"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xFileNameExt{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"xlsx"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"e24983ad-a8d4-4654-85fe-516b39e8f7e9","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6c3d8d8e-7be7-4b65-bef6-246fc183d89d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Error,$vErrorLineNumber.Number:toString$,$vErrorDescription$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"xFileNameExt"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"01-Validation: Input file Format"}}]},{"uid":"f837638a-7cd8-4002-b3ee-8f99737b15c1","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"bc450709-be48-4984-8eca-af39f9ae172d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5c6a5cf9-27ef-4929-84d0-c5cdbb7943f1","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}},{"name":"connectionMode","value":{"type":"STRING","string":"DEFAULT"}},{"name":"connectionOption","value":{"type":"STRING","string":"text"}},{"name":"connectionURL","value":{"type":"STRING","expression":"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$xFolderPath$/$xOutputFolderName$/$xOutputFileName$;Extended Properties=\"Excel 12.0 Xml;HDR=YES\";"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"61497264-61fe-422e-ad39-3ac94b797b7d","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}},{"name":"query","value":{"type":"STRING","string":"SELECT DISTINCT InvNum FROM [Sheet1$] WHERE Status ='NotCompleted'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"24c35dad-ad44-4a87-a43b-b80d10dc7d72","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"6605b158-a857-423f-a117-953e3bf0761a","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}},{"name":"query","value":{"type":"STRING","expression":"UPDATE [Sheet1$$] SET Status = 'NotCompleted' WHERE InvNum = '$vDistinctRecord[0]$'"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vDistinctRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"f8011f98-6eda-4b1b-8a36-af05b148898b","commandName":"sqlQuery","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}},{"name":"query","value":{"type":"STRING","string":"SELECT DISTINCT InvNum FROM [Sheet1$] WHERE Status ='InProgress'"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4b887740-900f-4b38-8b91-d1999b8ad6d5","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4463a353-24bc-46ba-afe4-a764131ba330","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vDistinctRecord"},"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.resultset","packageName":"Database"}}]},{"uid":"4ceba7e4-f049-4b63-9486-f9d3ac53a5f0","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"OutputSheet1"}}]}],"branches":[{"uid":"f9fb4727-d3bc-4e68-9d2c-9d9671c8ab64","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5b26b473-9f49-4855-99b4-bca81610e985","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xLogFolderName$/Log_$xTimeStamp$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$System:AATaskName$,Error,$vErrorLineNumber.Number:toString$,$vErrorDescription$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"05-Check the  status of line tem"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"xSOAPBody","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDeptID","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatementSequence","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xInputFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFileNameExt","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vColumnA","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vColumnB","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xLogFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSheetName","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"vErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"xScreenshotsFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIEndpoint","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIService","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIPort","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIOperation","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAPIResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatusCode","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorEnglishDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIWebserviceResponse","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"vAPIResponse","value":{"type":"STRING","string":"Null"}},{"key":"vStatusCode","value":{"type":"STRING","string":""}},{"key":"vErrorEnglishDescription","value":{"type":"STRING","string":""}}]}},{"name":"vStatus","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vComment","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBillSubArtCode","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vDepartmentName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vStatementDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBillNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTotalStatementVAT","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBillAmount","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vBillVAT","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xOutputFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xOutputFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFilePath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vConfigRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vSupplierNum","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vTotalStatement","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAmount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vVat","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"xArabicStringHandler","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"ANY","defaultValue":{"type":"DICTIONARY","dictionary":[{"key":"vComment","value":{"type":"STRING","string":""}}]}},{"name":"vDistinctRecord","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"xTemplateFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vInvNumber","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTRNNum","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20201014-042509"},{"name":"Comment","version":"2.2.0-20201014-042520"},{"name":"Database","version":"2.2.0-20201013-052941"},{"name":"Datetime","version":"2.2.0-20201014-042531"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"Excel_MS","version":"5.1.1-20201126-171913"},{"name":"File","version":"3.1.0-20201016-065515"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"LogToFile","version":"2.2.0-20201014-042806"},{"name":"Loop","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"TaskBot","version":"2.0.1-20201023-202703"},{"name":"XML","version":"2.1.0-20201014-043121"}],"workItemTemplateName":null}