{"triggers":[],"nodes":[{"uid":"532a03a6-ef16-472f-bd90-7856ac99dd73","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4930b4d8-1bcf-46fb-978a-3d65f5dfa830","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"addc8bbd-1134-4333-bb80-6cead5471e55","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","string":"Empty ABBYY output folder"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","string":""}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"da213ba9-9da0-4315-8f77-1ecf6f817bdd","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"1e172e0d-54f9-4d3b-8e30-0439dd864139","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xAbbyyOutputFolderPath$/$vFile{name}$.$vFile{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vFile"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xAbbyyOutputFolderPath$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"44090e4b-bea3-438c-b1e8-c6879ef7ac39","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"c16a0203-da42-49aa-81b7-97a0bf2e142d","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xAbbyyOutputFolderPath$/$vFolder$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vFolder"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xAbbyyOutputFolderPath$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.folder","packageName":"Folder"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Empty ABBYY output folder"}}]},{"uid":"39a84c47-bf33-444c-b369-dc5c0a818243","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"693f5cff-8368-4c48-877f-e2cdbfa9d868","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","string":"Create local temp folder inside local input folder to split single file into, if doesn't exist"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","string":""}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"21f6e38c-cacb-49f3-a9db-11c9aae62149","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"dfe60536-7296-41be-a7d0-4c8110ee0f6c","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"a07d2487-760a-4fc0-87af-bfa5069614f2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"2278f9a5-2c31-44e8-af51-fa7b51cb2d43","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$/*"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Create local temp folder inside local input folder to split single file into, if doesn't exist"}}]},{"uid":"8b0915bf-0288-4b74-9472-e8faa7affad2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"7a0e2d1a-e413-487f-abcd-f6b0238b8e2f","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","string":"Split document into multiple invoices based on company name"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","string":""}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"72113679-5166-440f-8aa2-69cbceeab739","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$xInputFileName$"}},{"name":"delimiter","value":{"type":"STRING","string":"."}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileName"}},{"uid":"4c4ea462-ce74-474d-acd1-7a3bd0faf77d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"220ce5bf-9c22-4fed-8c0b-eabe10d267c8","commandName":"splitDocument","packageName":"PDF","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xInputFileName$"}},{"name":"userSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"ownerSecureText","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"splitDocumentOptions","value":{"type":"STRING","string":"PAGES_PER_FILE"}},{"name":"pageCountPerFile","value":{"type":"NUMBER","number":"1"}},{"name":"outputDirectory","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$"}},{"name":"filePrefix","value":{"type":"STRING","expression":"$vFileName[0]$"}},{"name":"overwriteFile","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[{"uid":"c071eece-5a1d-4276-994a-e2d0e73db33d","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"0d7e4d0b-f023-4be3-b1b4-997e9a4c5ef7","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xInputFileName$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$/$xInputFileName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"شركة أبوظبي للتوزيع"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"شركة العين للتوزيع"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"هيئة كهرباء ومياه دبي"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"4cd447bb-7c9e-4f7d-ba33-0a17f048dee0","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7500d6a3-305d-4b12-aeb9-faeadf4a7ca2","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Warning"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"The bot is not trained to handle invoices from company $xCompanyName$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","string":""}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"الهيئة الاتحادية للكهرباء والماء"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"هيئة كهرباء ومياه الشارقة"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Split document into multiple invoices based on company name"}}]},{"uid":"59959777-e9fd-4654-bc39-28bfc2f9d0ad","commandName":"deleteFiles","packageName":"File","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xInputFileName$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"789c1fd8-a7c4-478f-85d8-9183cc9cd523","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"eaf1eb04-f7a2-4588-916e-0f53914d5656","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$xFolderPath$/$xInputFolderName$/$xCompanyName$/$xTempFolderName$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Delete local temp folder inside local input folder"}}]}],"branches":[{"uid":"86f66424-a7c8-4143-ad08-bff04a2a3cdf","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"02bf036f-b6d2-400f-9761-cf61c50631a6","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"1ca64849-ef52-471c-807d-b3f4875c71e6","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineNumberString"}},{"uid":"34ecdb88-dc8e-474c-84e6-fcd4ca573355","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumberString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"vErrorLineNumberString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xScreenshotsFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"xLogFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFile","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"xAbbyyOutputFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xCompanyName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xInputFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xInputFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vFileName","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"xTempFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"File","version":"2.2.0-20200831-031057"},{"name":"Folder","version":"2.2.0-20200831-031100"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"Loop","version":"2.1.0-20200831-031540"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"PDF","version":"2.5.0-20201014-042929"},{"name":"Step","version":"2.0.0-20200907-072944"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"TaskBot","version":"2.0.1-20200728-235256"}],"workItemTemplateName":null}