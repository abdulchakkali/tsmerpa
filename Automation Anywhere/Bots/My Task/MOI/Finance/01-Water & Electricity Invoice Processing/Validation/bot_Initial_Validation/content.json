{"triggers":[],"nodes":[{"uid":"f629228f-e58d-4c95-8876-3b4366e11fbd","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"62765abd-d283-4534-9f9c-5951276399ad","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"cd0ff364-e4bc-4102-ba54-49399619a46b","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","string":"Check if invoice number is unique for given company"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f41024f6-85fc-4b17-ac06-079eaa4c7879","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"Microsoft.Jet.OLEDB.4.0"}},{"name":"dbFilePath","value":{"type":"FILE","expression":"file://$xMasterDBFilePath$"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"b73bd731-939a-481f-8091-082f374535c3","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]},{"uid":"54c6b362-388a-4816-9bc2-1a7b69c12a21","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM $xTableName$ WHERE رقم_الدفعة = \"$xPaymentNumber$\" AND رقم_المورد = \"$xVendorNumber$\" AND تم_تحديث_نظام_المياه_والكهرباء = -1 AND تم_تسجيل_مستند_الصرف = -1;"}}],"returnTo":{"type":"VARIABLE","variableName":"vTableTemp"}},{"uid":"a4fa031a-7d4e-4024-ab0c-8de60e453778","commandName":"if","packageName":"If","disabled":true,"children":[{"uid":"cfa70ae8-2132-4e38-bd0d-e19ee2bbe215","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM $xTableName$ WHERE رقم_الفاتورة = \"$xInvoiceNumber$\" AND رقم_المورد = \"$xVendorNumber$\" AND تم_تحديث_نظام_المياه_والكهرباء = -1 AND تم_تسجيل_مستند_الصرف = -1;"}}],"returnTo":{"type":"VARIABLE","variableName":"vTableTemp"}}],"branches":[{"uid":"973ef533-5431-4c1d-a237-e641599a1aa7","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"db4f5815-9647-4b94-9700-58dea70b4e27","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM $xTableName$ WHERE (رقم_الفاتورة_كهرباء = \"$xInvoiceNoElectricity$\" OR رقم_الفاتورة_مياه = \"$xInvoiceNoWater$\") AND رقم_المورد = \"$xVendorNumber$\" AND تم_تحديث_نظام_المياه_والكهرباء = -1 AND تم_تسجيل_مستند_الصرف= -1;"}}],"returnTo":{"type":"VARIABLE","variableName":"vTableTemp"}}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xVendorNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8450"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xVendorNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"11456"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"80adb894-a1ca-4327-884d-8f76a28a0083","commandName":"else","packageName":"If","disabled":false,"children":[]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xVendorNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"10343"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xVendorNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8280"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xVendorNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8612"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"OR"},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"1588b68a-1228-4606-920f-64582337cc05","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c60d1eee-58ad-4b5d-a1d5-ddd46da4378e","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"xUniqueInvoiceNumber"}}],"branches":[{"uid":"a99f690c-79c0-4623-8f9a-d6931afe0735","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"dbad8ec0-ca05-4df4-b850-2444bf6b5316","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"xUniqueInvoiceNumber"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vTableTemp"}}],"value":{"type":"CONDITIONAL","conditionalName":"tableEmpty","packageName":"DataTable"}}]},{"uid":"2735e898-0a01-426e-b988-f9d49bf220b5","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]},{"uid":"b8ccc4e3-86aa-4d51-8e0f-7ed0d56b4b85","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Check if invoice number is unique for given company"}}]}],"branches":[{"uid":"51f10698-ab2f-479a-b01e-e5640b680458","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"c94fd635-16c7-47f3-a0ea-77121c31e3ce","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"7fa63246-7cdd-4c44-a11d-c933715acd75","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineNumberString"}},{"uid":"ef502613-5b0e-443b-a2e5-e3cd2ac65017","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumberString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"vErrorLineNumberString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"xPrimaryPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xScreenshotsFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xLogFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMasterDBFilePath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableTemp","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"xTableName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xVendorNumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xUniqueInvoiceNumber","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"xPaymentNumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200721-221936"},{"name":"DataTable","version":"2.0.0-20200721-222456"},{"name":"Database","version":"2.0.0-20200723-022707"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"TaskBot","version":"2.0.1-20200728-235256"}],"workItemTemplateName":null}