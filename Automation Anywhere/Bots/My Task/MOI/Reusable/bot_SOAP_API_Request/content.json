{"triggers":[],"nodes":[{"uid":"ee634695-70d8-4a17-bc76-b6875562d484","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9429e846-ecd0-40df-8238-3b8f872dde65","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"<soap:Header>      <wsse:Security soap:mustUnderstand=\"true\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">         <wsse:UsernameToken wsu:Id=\"UsernameToken-50B2D9B1F760B0A9C616139910035931\">            <wsse:Username>$vRpaServiceUserName$</wsse:Username>            <wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">$vRpaServicePassword$</wsse:Password>            <wsse:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">R1A2QDmOktZMtINIwQRY+Q==</wsse:Nonce>            <wsu:Created>2021-02-22T10:50:03.575Z</wsu:Created>         </wsse:UsernameToken>      </wsse:Security>   </soap:Header>"}}],"returnTo":{"type":"VARIABLE","variableName":"vSOAPHeader"}},{"uid":"02942522-16cb-4f6f-b100-5ca87d03c3db","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSOAPEnvelopStart$$vSOAPHeader$$xSOAPBody$$vSoapEnvelopEnd$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSOAPRawData"}},{"uid":"3deb23e1-4241-4589-a235-13535e973609","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"API Request :: $vSOAPRawData$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"76a7426a-7bbd-4851-9fe0-80c73b234556","commandName":"soapCommand","packageName":"SoapWebService","disabled":false,"attributes":[{"name":"wsdlUriOption","value":{"type":"STRING","string":"uri"}},{"name":"wsdlUri","value":{"type":"STRING","expression":"$xMOIAPIEndpoint$"}},{"name":"uri","value":{"type":"STRING","string":""}},{"name":"serviceName","value":{"type":"STRING","expression":"$xMOIAPIService$"}},{"name":"portName","value":{"type":"STRING","expression":"$xMOIAPIPort$"}},{"name":"soapVersion","value":{"type":"STRING","string":"SOAP 1.2 Protocol"}},{"name":"operation","value":{"type":"STRING","expression":"$xMOIOperation$"}},{"name":"radioValue","value":{"type":"STRING","string":"selectedResponse"}},{"name":"parameterOption","value":{"type":"STRING","string":"text"}},{"name":"rawData","value":{"type":"STRING","expression":"$vSOAPRawData$"}},{"name":"authenticationMode","value":{"type":"STRING","string":"NoAuthentication"}},{"name":"customHeaders","value":{"type":"LIST","list":[{"type":"DICTIONARY","dictionary":[{"key":"enabled","value":{"type":"BOOLEAN","boolean":true}},{"key":"name","value":{"type":"STRING","string":"Content-Type"}},{"key":"value","value":{"type":"STRING","string":"text/soap"}}]}]}},{"name":"scope","value":{"type":"STRING","string":"completeResponse"}}],"returnTo":{"type":"VARIABLE","variableName":"vAPIResponse"}},{"uid":"7e912fa0-9bbd-4127-a3c7-57eaafb80212","commandName":"startSession","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"inputType","value":{"type":"STRING","string":"text"}},{"name":"data","value":{"type":"STRING","expression":"$vAPIResponse$"}}]},{"uid":"51449b4a-2574-4d50-92c2-2b2afa1f3520","commandName":"validateXML","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"validationType","value":{"type":"STRING","string":"is wellformed"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"0cb12411-65f9-42c1-8e3c-e490304e03dc","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1f556025-a2f0-46b4-8be1-f89a3eaaf297","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Info"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"API Response :: $vAPIResponse$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"8978c0b4-da23-4fb4-a391-ec7fab0311fe","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3784a787-727f-45fb-bf02-20548b10a5a6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"200"}}],"returnTo":{"type":"VARIABLE","variableName":"vStatusCode"}},{"uid":"a4d8aa08-ffb4-4acd-b03a-6ea218e45dbf","commandName":"executeXPath","packageName":"XML","disabled":true,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetConstructionInvoiceResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='Invoice']/*[local-name()='VendorId']"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"9ccd2e62-30b5-4329-b71b-399f49fc6874","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"xptah : $prompt-assignment$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"20896e70-7860-4c88-9233-e00e75372644","commandName":"getSingleNode","packageName":"XML","disabled":true,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/*/soap:Body/*[local-name()='GetConstructionInvoiceResponse' and namespace-uri()=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\"]/*[local-name()='Content']/*[local-name()='Invoice']/*[local-name()='VendorId']"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"xSOAPBody"}},{"uid":"1272e6ec-f4a3-4691-a401-d8280036f61e","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$xSOAPBody$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"b933563b-d6cc-4b76-acc4-21ea851ef8f2","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"f526a3fa-f5cc-4031-b626-8c1277949a12","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/soap:Envelop/soap:Body/*/*/ListOfErrors/Error/ErrorCode"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vStatusCode"}},{"uid":"fbe9af0f-4720-46c0-a7dd-65e1b0549fa4","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/soap:Envelop/soap:Body/*/*/ListOfErrors/Error/ErrorEnglishDescription"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorEnglishDescription"}}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vAPIResponse$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Fault"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"358c07cd-47bd-458e-9b3d-797e1ea3c490","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"91afb2ed-26e1-4367-9289-f3559d7fe576","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/soap:Envelop/soap:Body/*/ListOfErrors/Error/ErrorCode"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vStatusCode"}},{"uid":"2af256ee-c591-4d61-b10d-04c279a2b448","commandName":"getSingleNode","packageName":"XML","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"sAPIResponse"}},{"name":"xPath","value":{"type":"STRING","string":"/soap:Envelop/soap:Body/*/ListOfErrors/Error/ErrorEnglishDescription"}},{"name":"attributeName","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorEnglishDescription"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vAPIResponse$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"Content"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"21a310e8-191f-4892-b886-2a81700b1e6a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"09ba71ea-feda-4437-b3ed-9e029212adc3","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","string":"API Response is not well formed"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"13638511-2b98-48cb-920f-03942f3c5399","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"VALID"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"728d7d96-5101-4228-8642-ae742c254155","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"0d66f477-0e3b-47ae-be9a-28cc0f00e5fa","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"ef47c83c-b45c-4de5-8e35-f21ffb0e142f","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumber.Number:toString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vRpaServiceUserName","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"finance_automation_testuser"}},{"name":"vRpaServicePassword","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"P@ssw0rd"}},{"name":"vStatusCode","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"xScreenshotsFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vSOAPHeader","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vSoapEnvelopEnd","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"</soap:Envelope>"}},{"name":"vSOAPEnvelopStart","description":"","type":"STRING","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"<soap:Envelope xmlns:rpas=\"http://www.moi.gov.ae/2020/Moi/FinanceAutomation/RPASchema\" xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\">"}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xLogFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIEndpoint","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIService","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIAPIPort","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vSOAPRawData","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vAPIResponse","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}},{"name":"xSOAPBody","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMOIOperation","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorEnglishDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":["ef47c83c-b45c-4de5-8e35-f21ffb0e142f"],"packages":[{"name":"Boolean","version":"2.1.0-20200831-031000"},{"name":"ErrorHandler","version":"2.2.0-20201014-042541"},{"name":"If","version":"2.1.0-20200921-085758"},{"name":"MessageBox","version":"2.1.0-20201014-042808"},{"name":"Number","version":"2.1.0-20201014-042823"},{"name":"SoapWebService","version":"3.1.0-20200921-090219"},{"name":"String","version":"3.1.0-20201014-043052"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"TaskBot","version":"2.0.1-20200728-235256"},{"name":"XML","version":"2.1.0-20201014-043121"}],"workItemTemplateName":null}