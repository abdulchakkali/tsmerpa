{"triggers":[],"nodes":[{"uid":"bcd431fe-6036-46fb-96ee-8024a2cea9cd","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ca872615-29e6-4e16-a4d4-d08a52e4b6ae","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c8ceda63-109f-4797-baac-9997fed42e5b","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"Microsoft.Jet.OLEDB.4.0"}},{"name":"dbFilePath","value":{"type":"FILE","expression":"file://$xMasterDBFilePath$"}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"370f4a41-3e9a-4d74-9a2e-43120cd66fea","commandName":"begin","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]},{"uid":"bd6a33a9-5796-4513-a511-37366938505a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"605c6497-86fa-43ff-8b72-7ff7676225d5","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM $xTableName$ WHERE رقم_الفاتورة = $xInvoiceNumber$;"}}],"returnTo":{"type":"VARIABLE","variableName":"vTableTemp"}}],"branches":[{"uid":"8a92c1d8-43e7-45e7-8f5d-57c7273e30b0","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"3cf8c1a7-6849-4529-8ba7-862cd2ed0b0b","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}},{"name":"query","value":{"type":"STRING","expression":"SELECT * FROM $xTableName$ WHERE رقم_الفاتورة_كهرباء = $xInvoiceNumberElectricity$ OR رقم_الفاتورة_مياه = $xInvoiceNumberWater$;"}}],"returnTo":{"type":"VARIABLE","variableName":"vTableTemp"}}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8450"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e16f0f56-0590-46ac-97e7-fe49499f9036","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"fc7aaea6-d17f-4902-8217-b1e0bad4aada","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"WARN - Company bot not trained for"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"10343"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8280"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$xCompanyNumber$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"8612"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"operator":"OR"},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"b664beba-3d66-4d11-bf0a-0842dd948808","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0ab1d400-2d2b-4f4b-890b-a7a409ca1596","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"xUniqueInvoiceNumber"}}],"branches":[{"uid":"7a70de04-ee2a-41e5-bdfa-59b86300b289","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"a241c95a-c4f3-408c-80e2-91ed39d1a4ea","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"xUniqueInvoiceNumber"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"table","value":{"type":"VARIABLE","variableName":"vTableTemp"}}],"value":{"type":"CONDITIONAL","conditionalName":"tableEmpty","packageName":"DataTable"}}]},{"uid":"093a495c-f9eb-4db9-9902-08385cfb8707","commandName":"commit","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]},{"uid":"3c50a57f-51a5-494b-bb2b-1dd9f6a57fb1","commandName":"disconnect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"AccessDB"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Check if invoice number is unique for given company"}}]}],"branches":[{"uid":"ccda48ed-c26d-4882-94ce-d0203da8e158","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"faf1e72c-3d44-46d4-8e18-141996933f27","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"vTaskCompleted"}},{"uid":"ef1ba4cc-0376-4bed-9c38-b43f189d1839","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vErrorLineNumberString"}},{"uid":"47f9a1b9-6472-4437-9f03-100e54e3da01","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"xScreenshotsFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xScreenshotsFolderName$"}},{"key":"xLogFolderPath","value":{"type":"STRING","expression":"$xPrimaryPath$$xFolderPath$\\$xLogFolderName$"}},{"key":"xBotName","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"key":"xMessageType","value":{"type":"STRING","string":"Error"}},{"key":"xMessageContent","value":{"type":"STRING","expression":"$vErrorMessage$"}},{"key":"xTimeStamp","value":{"type":"STRING","expression":"$xTimeStamp$"}},{"key":"xErrorLineNumber","value":{"type":"STRING","expression":"$vErrorLineNumberString$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Task/MOI/Reusable/Log_To_File/Log_To_File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"xInvoiceNumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xScreenshotsFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xLogFolderName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"xTimeStamp","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xMasterDBFilePath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xTableName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vTableTemp","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"xCompanyNumber","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xInvoiceNumberWater","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xInvoiceNumberElectricity","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"xUniqueInvoiceNumber","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":false}},{"name":"xPrimaryPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumberString","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vTaskCompleted","description":"","type":"BOOLEAN","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"BOOLEAN","boolean":true}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200721-221936"},{"name":"Comment","version":"2.0.0-20200721-221948"},{"name":"DataTable","version":"2.0.0-20200721-222456"},{"name":"Database","version":"2.0.0-20200723-022707"},{"name":"ErrorHandler","version":"2.0.0-20200721-222009"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"Step","version":"2.0.0-20200723-201827"},{"name":"String","version":"3.0.0-20200721-222454"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"TaskBot","version":"2.0.1-20200728-235256"}],"workItemTemplateName":null}